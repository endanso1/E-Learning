<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AR/VR Lab ‚Äì Microcontrollers</title>

<link rel="icon" href="logoGctu.png" type="image/png" />

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- model-viewer -->
<script type="module"
src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
body{
background:#0c1d3c;
color:white;
font-family:'Segoe UI',sans-serif;
}

h1,h2,h3,h4,h5{ color:#ffd700; }

.lab-section{
padding:60px 20px;
text-align:center;
}

model-viewer{
width:100%;
height:500px;
background:black;
border-radius:12px;
}

.btn-primary{
background:#ffd700;
color:#0c1d3c;
border:none;
}

.btn-success{
background:#28a745;
border:none;
}

.note-box{
background:#122850;
padding:20px;
border-radius:12px;
margin-top:40px;
}

footer{
background:#0a172f;
padding:20px;
text-align:center;
color:#aaa;
}

.progress{
height:8px;
margin-top:10px;
}

@media(max-width:576px){
model-viewer{ height:350px; }
}
</style>
</head>

<body>

<div class="container text-center py-4">
<a href="index.html" class="btn btn-primary mb-3">‚¨Ö Back</a>
<h1>üî¨ AR/VR Microcontroller Lab</h1>
<p class="lead">Interact with a 3D chip in Augmented or Virtual Reality</p>
</div>

<!-- Device Notice -->
<div class="container note-box">
<h5>‚Ñπ Requirements</h5>
<ul>
<li>AR ‚Üí Supported Android or iPhone</li>
<li>VR ‚Üí WebXR headset (Meta Quest, Vive, etc.)</li>
<li>Desktop ‚Üí 3D interaction only</li>
<li>‚ö† Page must be opened over HTTPS for VR</li>
</ul>
</div>

<!-- LAB -->
<div class="container lab-section">

<model-viewer
id="chipViewer"
src="media/chip.glb"
poster="media/vr_ar4.jpg"
alt="Microcontroller"
ar
ar-modes="scene-viewer webxr quick-look"
camera-controls
auto-rotate
environment-image="neutral"
shadow-intensity="1"
reveal="interaction">

<button slot="ar-button" class="btn btn-primary mt-3">
üì± View in AR
</button>

<div class="progress" slot="progress-bar">
<div id="progressBar"
class="progress-bar progress-bar-striped progress-bar-animated"
style="width:0%"></div>
</div>

</model-viewer>

<button id="vrBtn" class="btn btn-success mt-4" disabled>
üï∂ Enter VR Mode
</button>

<div id="statusMsg" class="mt-3"></div>

</div>

<!-- GUIDE -->
<div class="container note-box">
<h4>How to Use</h4>
<ol>
<li>Wait for model to load</li>
<li>Tap AR to place in real world</li>
<li>Use VR if headset is connected</li>
<li>If nothing works ‚Üí update browser</li>
</ol>
</div>

<footer>
¬© 2025 Inside the Chip ‚Äì AR/VR Lab
</footer>

<script>

const viewer = document.getElementById("chipViewer");
const vrBtn = document.getElementById("vrBtn");
const statusMsg = document.getElementById("statusMsg");
const progressBar = document.getElementById("progressBar");


// ----------------------
// MODEL LOADING PROGRESS
// ----------------------
viewer.addEventListener("progress", e=>{
const percent = Math.round(e.detail.totalProgress * 100);
progressBar.style.width = percent + "%";
});


// ----------------------
// MODEL LOADED
// ----------------------
viewer.addEventListener("load", ()=>{
statusMsg.innerHTML = "‚úÖ Model ready";
checkVRSupport();
});


// ----------------------
// LOAD ERROR
// ----------------------
viewer.addEventListener("error", ()=>{
statusMsg.innerHTML =
"‚ùå Failed to load 3D model. Check file path.";
});


// ----------------------
// VR SUPPORT CHECK
// ----------------------
async function checkVRSupport(){

if(!navigator.xr){
statusMsg.innerHTML += "<br>‚ùå WebXR not available";
return;
}

try{
const supported =
await navigator.xr.isSessionSupported("immersive-vr");

if(supported){
vrBtn.disabled = false;
statusMsg.innerHTML += "<br>üü¢ VR Supported";
}else{
statusMsg.innerHTML += "<br>‚ùå VR not supported";
}
}
catch(err){
statusMsg.innerHTML += "<br>‚ö† VR check failed";
}
}


// ----------------------
// ENTER VR
// ----------------------
vrBtn.onclick = async ()=>{

try{
const shadowRoot = viewer.shadowRoot;
const vrButton =
shadowRoot.querySelector('button[aria-label="Enter VR"]');

if(vrButton){
vrButton.click();
}else{
alert("VR not ready yet");
}
}
catch(e){
alert("Unable to enter VR");
}
};

</script>

</body>
</html>
